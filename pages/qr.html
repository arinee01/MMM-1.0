<!DOCTYPE html>
<html lang="en">

<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>QR Redirect</title>
  <script>
    document.addEventListener("DOMContentLoaded", () => {
      // Считываем id из ссылки: qr.html?id=AMULET-XXX
      const params = new URLSearchParams(window.location.search);
      const artifactId = params.get("id");

      if (artifactId) {
        // Определяем базовый путь для репозитория
        const pathname = window.location.pathname;
        let basePath = '';
        if (pathname.includes('/MMM-1.0/')) {
          basePath = '/MMM-1.0';
        } else if (pathname.includes('/MMM-main/')) {
          basePath = '/MMM-main';
        }

        // Специальные случаи для амулетов, которые идут на magic.html
        const magicAmulets = [
          'AMULET-TURKISH-001',      // Turkish Evil Eye
          'AMULET-ROSE-QUARTZ-001',  // Rose Quartz  
          'AMULET-BLACK-STONE-001'   // Black Stone
        ];

        let targetUrl;
        if (magicAmulets.includes(artifactId)) {
          targetUrl = `${basePath}/pages/magic.html?id=${artifactId}&src=qr`;
        } else {
          targetUrl = `${basePath}/pages/chrono.html?id=${artifactId}&src=qr`;
        }

        // Редиректим на нужную страницу с параметром id
        window.location.href = targetUrl;
      } else {
        // Если id нет — выводим ошибку
        document.body.innerHTML = "<h2>QR-код неверный или устаревший</h2>";
      }
    });
  </script>
</head>

<body>
  <h2>Загрузка...</h2>
</body>

</html>